C:\Users\KillDeath\PycharmProjects\PythonProject1\.venv\Scripts\python.exe C:\Users\KillDeath\PycharmProjects\PythonProject1\Banks_Scoring\Scoring_models\scripts\main.py 
d_sample_data=      Application  loan_amount  ...  step          created_at
0              1         3000  ...     3 2021-02-01 00:20:01
1              2         1000  ...     3 2021-02-01 00:20:04
2              3         1000  ...     7 2021-02-01 00:22:13
3              4         1600  ...     3 2021-02-01 00:22:15
4              5         2500  ...     7 2021-02-01 00:23:03
..           ...          ...  ...   ...                 ...
494          495         1000  ...     7 2021-02-03 00:55:41
495          496          500  ...     7 2021-02-03 01:23:54
496          497         2500  ...     7 2021-02-03 01:43:13
497          498         1050  ...     3 2021-02-03 01:51:31
498          499         1300  ...     3 2021-02-03 01:54:18

[499 rows x 67 columns]
-------------  Column Names  -----------
Index(['Application', 'loan_amount', 'loan_days', 'applied_at', 'gender_id',
       'Unnamed: 5', 'birth_date', 'Marital status', 'children_count_id',
       'education_id', 'fact_addr_owner_type_id', 'fact_addr_start_date',
       'has_immovables', 'has_movables', 'employment_type_id', 'position_id',
       'organization_type_id', 'organization_branch_id', 'empoyees_count_id',
       'employment_date', 'seniority_years', 'has_prior_employment',
       'prior_employment_start_date', 'prior_employment_end_date',
       'monthly_income', 'income_frequency_id', 'income_frequency_other',
       'income_source_id', 'monthly_expenses', 'other_loans_has_closed',
       'other_loans_active', 'other_loans_about_current',
       'other_loans_about_monthly', 'OK*', 'loan_closed', 'loan_overdue',
       'product_id', 'product_dpr', 'product_amount_from', 'product_amount_to',
       'product_overdue_dpr', 'product_interest_min',
       'product_overdue_start_day', 'product_base_amount_limit',
       'amount_limit', 'applied_limit', 'amount_to_pay', 'total_paid',
       'current_interest_amount', 'current_overdue_interest_amount',
       'current_rest_amount', 'current_principal_balance', 'overdue_amount',
       'overdue_days', 'extension_amount', 'extension_days', 'payment_date',
       'closed_at', 'product_profile_id', 'credit_policy_id', 'user_id',
       'face_id', 'prolongation_number', 'prolongation_total_days',
       'wizard_type_id', 'step', 'created_at'],
      dtype='object')
---------  Column Data Types  -----------
Application                         int64
loan_amount                         int64
loan_days                           int64
applied_at                 datetime64[ns]
gender_id                           int64
                                ...      
prolongation_number               float64
prolongation_total_days           float64
wizard_type_id                      int64
step                                int64
created_at                 datetime64[ns]
Length: 67, dtype: object
---------  Missing Values Summary  ------
Application                  0
loan_amount                  0
loan_days                    0
applied_at                   0
gender_id                    0
                          ... 
prolongation_number        436
prolongation_total_days    436
wizard_type_id               0
step                         0
created_at                   0
Length: 67, dtype: int64
---------------  d_data_description  ---------------
d_data_description=        Field_in_data  ...                                               Note
0                 id  ...                                                NaN
1        loan_amount  ...                                                NaN
2          loan_days  ...                                                NaN
3         applied_at  ...  Локальний час на пристрої користувача або час ...
4           language  ...                                          Завжди UА
..               ...  ...                                                ...
115  cardholder_name  ...                                                NaN
116          face_id  ...                                                NaN
117             step  ...                                                NaN
118       created_at  ...  Локальний час на пристрої користувача або час ...
119       updated_at  ...  Локальний час на пристрої користувача або час ...

[120 rows x 6 columns]
----------------------------------------------------
---------  d_segment_data_description_client_bank  -----------
d_segment_data_description_client_bank=                           Field_in_data  ...                        Note
0                           loan_amount  ...                         NaN
1                             loan_days  ...                         NaN
2                         purpose_other  ...                         NaN
3                             gender_id  ...     Потрібна расшифровка id
4                            birth_date  ...  Іноді заповнюєтья не вірно
..                                  ...  ...                         ...
73  product_overdue_start_day            ...                         NaN
74            product_base_amount_limit  ...                         NaN
75                         amount_limit  ...                         NaN
76                        applied_limit  ...                         NaN
77                        amount_to_pay  ...                         NaN

[78 rows x 6 columns]
----------------------------------------------------
-----------------------------------------
⚠️ Column match flag: Flag_False
j =  38
✔ Matching column indices: [ 0.  1.  3.  4.  6.  7. 35. 36. 37. 38. 39. 40. 43. 45. 47. 48. 49. 53.
 55. 56. 57. 58. 59. 60. 62. 63. 64. 65. 66. 67. 68. 69. 70. 72. 74. 75.
 76. 77.]
------------ Filtered Indicator Metadata -------------
                  Field_in_data  ...                          Note
0                   loan_amount  ...                           NaN
1                     loan_days  ...                           NaN
2                     gender_id  ...       Потрібна расшифровка id
3                    birth_date  ...    Іноді заповнюєтья не вірно
4             children_count_id  ...       Потрібна расшифровка id
5                  education_id  ...       Потрібна расшифровка id
6       fact_addr_owner_type_id  ...       Потрібна расшифровка id
7          fact_addr_start_date  ...                           NaN
8                has_immovables  ...                           NaN
9                  has_movables  ...                           NaN
10           employment_type_id  ...       Потрібна расшифровка id
11                  position_id  ...       Потрібна расшифровка id
12         organization_type_id  ...       Потрібна расшифровка id
13       organization_branch_id  ...       Потрібна расшифровка id
14            empoyees_count_id  ...       Потрібна расшифровка id
15              employment_date  ...  Повинна бути заповнена вірно
16              seniority_years  ...   Повинен бути вказаний вірно
17         has_prior_employment  ...                           NaN
18  prior_employment_start_date  ...                           NaN
19    prior_employment_end_date  ...                           NaN
20               monthly_income  ...                           NaN
21          income_frequency_id  ...                           NaN
22       income_frequency_other  ...                           NaN
23             income_source_id  ...                           NaN
24             monthly_expenses  ...                           NaN
25       other_loans_has_closed  ...                           NaN
26           other_loans_active  ...                           NaN
27    other_loans_about_current  ...                           NaN
28    other_loans_about_monthly  ...                           NaN
29                   product_id  ...                           NaN
30                  product_dpr  ...                           NaN
31          product_amount_from  ...                           NaN
32            product_amount_to  ...                           NaN
33         product_interest_min  ...                           NaN
34    product_base_amount_limit  ...                           NaN
35                 amount_limit  ...                           NaN
36                applied_limit  ...                           NaN
37                amount_to_pay  ...                           NaN

[38 rows x 6 columns]
------------------------------------------------------
--------- 1.5.2 (extended) – Feature Engineering -----------
---- Missing values in final sample segment --------
loan_amount                      0
loan_days                        0
gender_id                        0
children_count_id                0
education_id                     0
fact_addr_owner_type_id          0
has_immovables                   0
has_movables                     0
employment_type_id               0
position_id                    162
organization_type_id             0
organization_branch_id           0
empoyees_count_id                0
seniority_years                  0
has_prior_employment           494
prior_employment_start_date    164
prior_employment_end_date      164
monthly_income                   0
income_frequency_id              0
income_frequency_other         467
income_source_id                 0
monthly_expenses                 0
other_loans_has_closed           0
other_loans_active               0
other_loans_about_current        0
other_loans_about_monthly        0
product_id                       0
product_dpr                      0
product_amount_from              0
product_amount_to                0
product_interest_min             0
product_base_amount_limit        0
amount_limit                     0
applied_limit                    0
amount_to_pay                    0
age                              0
addr_duration_years              0
employment_duration_years        0
dtype: int64
----------------------------------------------------
--- Missing values in cleaned indicator data ---
loan_amount                  0
loan_days                    0
gender_id                    0
children_count_id            0
education_id                 0
fact_addr_owner_type_id      0
has_immovables               0
has_movables                 0
employment_type_id           0
organization_type_id         0
organization_branch_id       0
empoyees_count_id            0
seniority_years              0
monthly_income               0
income_frequency_id          0
income_source_id             0
monthly_expenses             0
other_loans_has_closed       0
other_loans_active           0
other_loans_about_current    0
other_loans_about_monthly    0
product_id                   0
product_dpr                  0
product_amount_from          0
product_amount_to            0
product_interest_min         0
product_base_amount_limit    0
amount_limit                 0
applied_limit                0
amount_to_pay                0
age                          0
addr_duration_years          0
employment_duration_years    0
dtype: int64
---------- Final scoring dataset -----------
     loan_amount  loan_days  ...  addr_duration_years  employment_duration_years
0           3000         30  ...                  5.6                        5.6
1           1000          7  ...                 14.8                        8.6
2           1000          3  ...                  2.7                        4.6
3           1600         30  ...                 28.2                        5.4
4           2500         18  ...                 22.1                        2.7
..           ...        ...  ...                  ...                        ...
494         1000         15  ...                 14.9                        3.5
495          500          3  ...                  7.5                        6.5
496         2500         30  ...                 24.7                        4.4
497         1050         14  ...                  8.2                        8.1
498         1300          4  ...                 11.7                        4.7

[499 rows x 33 columns]
----------------- Final indicator metadata  ----------------
                Field_in_data  ...                          Note
0                 loan_amount  ...                           NaN
1                   loan_days  ...                           NaN
2                   gender_id  ...       Потрібна расшифровка id
3                  birth_date  ...    Іноді заповнюєтья не вірно
4           children_count_id  ...       Потрібна расшифровка id
5                education_id  ...       Потрібна расшифровка id
6     fact_addr_owner_type_id  ...       Потрібна расшифровка id
7        fact_addr_start_date  ...                           NaN
8              has_immovables  ...                           NaN
9                has_movables  ...                           NaN
10         employment_type_id  ...       Потрібна расшифровка id
11       organization_type_id  ...       Потрібна расшифровка id
12     organization_branch_id  ...       Потрібна расшифровка id
13          empoyees_count_id  ...       Потрібна расшифровка id
14            employment_date  ...  Повинна бути заповнена вірно
15            seniority_years  ...   Повинен бути вказаний вірно
16             monthly_income  ...                           NaN
17        income_frequency_id  ...                           NaN
18           income_source_id  ...                           NaN
19           monthly_expenses  ...                           NaN
20     other_loans_has_closed  ...                           NaN
21         other_loans_active  ...                           NaN
22  other_loans_about_current  ...                           NaN
23  other_loans_about_monthly  ...                           NaN
24                 product_id  ...                           NaN
25                product_dpr  ...                           NaN
26        product_amount_from  ...                           NaN
27          product_amount_to  ...                           NaN
28       product_interest_min  ...                           NaN
29  product_base_amount_limit  ...                           NaN
30               amount_limit  ...                           NaN
31              applied_limit  ...                           NaN
32              amount_to_pay  ...                           NaN

[33 rows x 6 columns]
------------------------------------------------------------
✅ age_transformed generated — used as "max" criterion in Voronin model
📊 Selected Min/Max Criteria Description:
    Unnamed: 0  ...                          Note
0            0  ...                           NaN
1            1  ...                           NaN
2            3  ...  Иногда заполнена неправильно
3            4  ...       Потрібна расшифровка id
4            5  ...       Потрібна расшифровка id
5            6  ...       Потрібна расшифровка id
6            7  ...                           NaN
7            8  ...                           NaN
8            9  ...       Потрібна расшифровка id
9           10  ...       Потрібна расшифровка id
10          11  ...       Потрібна расшифровка id
11          12  ...       Потрібна расшифровка id
12          13  ...  Повинна бути заповнена вірно
13          14  ...                           NaN
14          15  ...                           NaN
15          16  ...                           NaN
16          17  ...                           NaN
17          18  ...                           NaN
18          19  ...                           NaN
19          20  ...                           NaN
20          21  ...                           NaN
21          23  ...                           NaN
22          24  ...                           NaN
23          25  ...                           NaN
24          26  ...                           NaN
25          27  ...                           NaN
26          28  ...                           NaN
27          29  ...                           NaN
28          30  ...                           NaN
29          31  ...                           NaN
30          32  ...                           NaN

[31 rows x 8 columns]
⚖ Raw Weights from Excel:
[0.06309148 0.04731861 0.04731861 0.01892744 0.02523659 0.03154574
 0.04731861 0.03154574 0.03154574 0.01577287 0.01577287 0.01892744
 0.03785489 0.06309148 0.03154574 0.03154574 0.06309148 0.07886435
 0.06309148 0.06309148 0.03154574 0.04731861 0.01577287 0.01577287
 0.00630915 0.00630915 0.00630915 0.01577287 0.00630915 0.00630915
 0.01577287]
📄 Selected Feature Columns:
['loan_amount', 'loan_days', 'age', 'children_count_id', 'education_id', 'fact_addr_owner_type_id', 'has_immovables', 'has_movables', 'employment_type_id', 'organization_type_id', 'organization_branch_id', 'empoyees_count_id', 'seniority_years', 'monthly_income', 'income_frequency_id', 'income_source_id', 'monthly_expenses', 'other_loans_has_closed', 'other_loans_active', 'other_loans_about_current', 'other_loans_about_monthly', 'product_dpr', 'product_amount_from', 'product_amount_to', 'product_interest_min', 'product_base_amount_limit', 'amount_limit', 'applied_limit', 'amount_to_pay', 'addr_duration_years', 'employment_duration_years']
     loan_amount  loan_days  ...  addr_duration_years  employment_duration_years
0           3000         30  ...                  5.6                        5.6
1           1000          7  ...                 14.8                        8.6
2           1000          3  ...                  2.7                        4.6
3           1600         30  ...                 28.2                        5.4
4           2500         18  ...                 22.1                        2.7
..           ...        ...  ...                  ...                        ...
494         1000         15  ...                 14.9                        3.5
495          500          3  ...                  7.5                        6.5
496         2500         30  ...                 24.7                        4.4
497         1050         14  ...                  8.2                        8.1
498         1300          4  ...                 11.7                        4.7

[499 rows x 31 columns]
📉 Min values per column:
loan_amount                  300.0
loan_days                      3.0
age                           20.1
children_count_id              1.0
education_id                   1.0
fact_addr_owner_type_id        0.0
has_immovables                 0.0
has_movables                   0.0
employment_type_id             1.0
organization_type_id           0.0
organization_branch_id         0.0
empoyees_count_id              0.0
seniority_years                0.0
monthly_income                15.0
income_frequency_id            1.0
income_source_id               1.0
monthly_expenses             100.0
other_loans_has_closed         0.0
other_loans_active             0.0
other_loans_about_current      0.0
other_loans_about_monthly      0.0
product_dpr                    0.0
product_amount_from            0.0
product_amount_to            700.0
product_interest_min          30.0
product_base_amount_limit    700.0
amount_limit                 300.0
applied_limit                300.0
amount_to_pay                -32.0
addr_duration_years            0.0
employment_duration_years     -0.8
dtype: float64
📈 Max values per column:
loan_amount                    8000.0
loan_days                        30.0
age                              61.9
children_count_id                 5.0
education_id                      6.0
fact_addr_owner_type_id           4.0
has_immovables                    1.0
has_movables                      1.0
employment_type_id                8.0
organization_type_id              5.0
organization_branch_id           11.0
empoyees_count_id                 3.0
seniority_years                  48.0
monthly_income               160000.0
income_frequency_id               3.0
income_source_id                  6.0
monthly_expenses              60000.0
other_loans_has_closed            1.0
other_loans_active             8000.0
other_loans_about_current     80000.0
other_loans_about_monthly     30000.0
product_dpr                       1.9
product_amount_from             500.0
product_amount_to              8000.0
product_interest_min            450.0
product_base_amount_limit      8000.0
amount_limit                  16000.0
applied_limit                  8000.0
amount_to_pay                 12320.0
addr_duration_years              49.5
employment_duration_years        51.1
dtype: float64
✅ Normalized Minimax Matrix (Preview):
[[3.75009374e-01 9.90196078e-01 5.28052805e-04 ... 2.43494635e-05
  6.65335995e-02 6.44745326e-02]
 [1.25028123e-01 2.38562092e-01 2.19178082e-03 ... 2.43494635e-05
  6.65335995e-02 6.44745326e-02]
 [1.25028123e-01 1.07843137e-01 4.84848485e-03 ... 8.83317371e-02
  1.83406045e-05 1.77730036e-05]
 ...
 [3.12514061e-01 9.90196078e-01 5.28052805e-04 ... 2.43494635e-05
  6.65335995e-02 6.44745326e-02]
 [1.31277654e-01 4.67320261e-01 1.11888112e-03 ... 1.09247926e-01
  1.48291826e-05 1.43702524e-05]
 [1.62525311e-01 1.40522876e-01 3.72093023e-03 ... 2.43494635e-05
  6.65335995e-02 6.44745326e-02]]

🔍 Top-5 Clients with Highest Scor (Potential Fraud Alert):

▶ Client 474 — Scor = 18793.79
  ▶ Feature: loan_amount
     Real Value = 8000.0
     Contribution to Scor = 1682.57 (Weight 0.063)
  ▶ Feature: other_loans_about_current
     Real Value = 80000.0
     Contribution to Scor = 16824.52 (Weight 0.063)
  ▶ Feature: product_amount_from
     Real Value = 500.0
     Contribution to Scor = 26.32 (Weight 0.016)
  ▶ Feature: amount_to_pay
     Real Value = 12320.0
     Contribution to Scor = 259.11 (Weight 0.006)
⚠️ Alert: Client has 4 indicators > 0.99 — High Fraud Risk

▶ Client 468 — Scor = 12646.07
  ▶ Feature: monthly_expenses
     Real Value = 60000.0
     Contribution to Scor = 12618.42 (Weight 0.063)
  ▶ Feature: product_amount_from
     Real Value = 500.0
     Contribution to Scor = 26.32 (Weight 0.016)
⚠️ Warning: Client has 2 indicators with high potential risk

▶ Client 463 — Scor = 3187.15
  ▶ Feature: loan_days
     Real Value = 30.0
     Contribution to Scor = 4.83 (Weight 0.047)
  ▶ Feature: other_loans_about_monthly
     Real Value = 30000.0
     Contribution to Scor = 3154.64 (Weight 0.032)
  ▶ Feature: product_amount_from
     Real Value = 500.0
     Contribution to Scor = 26.32 (Weight 0.016)
⚠️ Alert: Client has 3 indicators > 0.99 — High Fraud Risk

▶ Client 243 — Scor = 1974.00
  ▶ Feature: loan_amount
     Real Value = 8000.0
     Contribution to Scor = 1682.57 (Weight 0.063)
  ▶ Feature: loan_days
     Real Value = 30.0
     Contribution to Scor = 4.83 (Weight 0.047)
  ▶ Feature: product_amount_from
     Real Value = 500.0
     Contribution to Scor = 26.32 (Weight 0.016)
  ▶ Feature: amount_to_pay
     Real Value = 12320.0
     Contribution to Scor = 259.11 (Weight 0.006)
⚠️ Alert: Client has 4 indicators > 0.99 — High Fraud Risk

▶ Client 475 — Scor = 1714.95
  ▶ Feature: loan_amount
     Real Value = 8000.0
     Contribution to Scor = 1682.57 (Weight 0.063)
  ▶ Feature: loan_days
     Real Value = 30.0
     Contribution to Scor = 4.83 (Weight 0.047)
  ▶ Feature: product_amount_from
     Real Value = 500.0
     Contribution to Scor = 26.32 (Weight 0.016)
⚠️ Alert: Client has 3 indicators > 0.99 — High Fraud Risk

⚠️ Warning: Full optimization may take 10–15 minutes. Recommended for first-time only.

Enter mode (1 — optimization, 2 — use best model): 2
🚀 Using best saved model (Mode 2)
🎯 Accuracy (Test): 1.0
📉 Loss (Test): 0.0589
📈 ROC AUC (macro, OVO): 1.0
🧩 Confusion matrix:
 [[ 6  0  0  0]
 [ 0 43  0  0]
 [ 0  0 50  0]
 [ 0  0  0  1]]

Process finished with exit code 0
